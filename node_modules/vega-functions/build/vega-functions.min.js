var vega=function(t,n,e,i,r,o,a,s,c){"use strict";function u(t){const n=this.context.data[t];return n?n.values.value:[]}function l(t,n,e){const i=this.context.data[t]["index:"+n],r=i?i.value.get(e):void 0;return r?r.count:r}function h(t,e){const i=this.context.dataflow,r=this.context.data[t].input;return i.pulse(r,i.changeset().remove(n.truthy).insert(e)),1}function f(t,n,e){if(t){const e=this.context.dataflow,i=t.mark.source;e.pulse(i,e.changeset().encode(t,n))}return void 0!==e?e:t}const d=t=>function(n,e){return this.context.dataflow.locale()[t](e)(n)},g=d("format"),p=d("timeFormat"),m=d("utcFormat"),y=d("timeParse"),b=d("utcParse"),w=new Date(2e3,0,1);function v(t,n,e){return Number.isInteger(t)&&Number.isInteger(n)?(w.setYear(2e3),w.setMonth(t),w.setDate(n),p.call(this,w,e)):""}function x(t){return v.call(this,t,1,"%B")}function N(t){return v.call(this,t,1,"%b")}function S(t){return v.call(this,0,2+t,"%A")}function k(t){return v.call(this,0,2+t,"%a")}const M="%";function E(t,i,r,o){i[0].type!==e.Literal&&n.error("First argument to data functions must be a string literal.");const a=i[0].value,s=":"+a;if(!n.hasOwnProperty(s,o))try{o[s]=r.getData(a).tuplesRef()}catch(t){}}function P(t,i,r,o){i[0].type!==e.Literal&&n.error("First argument to indata must be a string literal."),i[1].type!==e.Literal&&n.error("Second argument to indata must be a string literal.");const a=i[0].value,s=i[1].value,c="@"+s;n.hasOwnProperty(c,o)||(o[c]=r.getData(a).indataRef(r,s))}function q(t,n,i,r){if(n[0].type===e.Literal)L(i,r,n[0].value);else for(t in i.scales)L(i,r,t)}function L(t,e,i){const r=M+i;if(!n.hasOwnProperty(e,r))try{e[r]=t.scaleRef(i)}catch(t){}}function F(t,e){let i;return n.isFunction(t)?t:n.isString(t)?(i=e.scales[t])&&i.value:void 0}function R(t,i,r){i.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,r._bandwidth=q,r._range=q,r._scale=q;const o=i=>"_["+(i.type===e.Literal?n.stringValue(M+i.value):n.stringValue(M)+"+"+t(i))+"]";return{_bandwidth:t=>"this.__bandwidth(".concat(o(t[0]),")"),_range:t=>"".concat(o(t[0]),".range()"),_scale:n=>"".concat(o(n[0]),"(").concat(t(n[1]),")")}}class _{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let e=0;for(let i=0;i<this._n&&i<32;i++){const r=n[i],o=t+r,a=Math.abs(t)<Math.abs(r)?t-(o-r):r-(o-t);a&&(n[e++]=a),t=o}return n[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let n,e,i,r=this._n,o=0;if(r>0){for(o=t[--r];r>0&&(n=o,e=t[--r],o=n+e,i=e-(o-n),!i););r>0&&(i<0&&t[r-1]<0||i>0&&t[r-1]>0)&&(e=2*i,n=o+e,e==n-o&&(o=n))}return o}}var A=1e-6,O=Math.PI,z=O/2,$=O/4,D=2*O,U=180/O,V=O/180,B=Math.abs,H=Math.atan2,I=Math.cos,j=Math.hypot,C=Math.sin,T=Math.sqrt;function X(t){return t>1?z:t<-1?-z:Math.asin(t)}function Y(){}function G(t,n){t&&J.hasOwnProperty(t.type)&&J[t.type](t,n)}var W={Feature:function(t,n){G(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,i=-1,r=e.length;++i<r;)G(e[i].geometry,n)}},J={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,i=-1,r=e.length;++i<r;)t=e[i],n.point(t[0],t[1],t[2])},LineString:function(t,n){K(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,i=-1,r=e.length;++i<r;)K(e[i],n,0)},Polygon:function(t,n){Q(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,i=-1,r=e.length;++i<r;)Q(e[i],n)},GeometryCollection:function(t,n){for(var e=t.geometries,i=-1,r=e.length;++i<r;)G(e[i],n)}};function K(t,n,e){var i,r=-1,o=t.length-e;for(n.lineStart();++r<o;)i=t[r],n.point(i[0],i[1],i[2]);n.lineEnd()}function Q(t,n){var e=-1,i=t.length;for(n.polygonStart();++e<i;)K(t[e],n,1);n.polygonEnd()}function Z(t,n){t&&W.hasOwnProperty(t.type)?W[t.type](t,n):G(t,n)}var tt,nt,et,it,rt,ot,at,st,ct,ut,lt,ht,ft,dt,gt,pt,mt=new _,yt=new _,bt={point:Y,lineStart:Y,lineEnd:Y,polygonStart:function(){mt=new _,bt.lineStart=wt,bt.lineEnd=vt},polygonEnd:function(){var t=+mt;yt.add(t<0?D+t:t),this.lineStart=this.lineEnd=this.point=Y},sphere:function(){yt.add(D)}};function wt(){bt.point=xt}function vt(){Nt(tt,nt)}function xt(t,n){bt.point=Nt,tt=t,nt=n,et=t*=V,it=I(n=(n*=V)/2+$),rt=C(n)}function Nt(t,n){var e=(t*=V)-et,i=e>=0?1:-1,r=i*e,o=I(n=(n*=V)/2+$),a=C(n),s=rt*a,c=it*o+s*I(r),u=s*i*C(r);mt.add(H(u,c)),et=t,it=o,rt=a}function St(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}var kt,Mt,Et,Pt,qt,Lt,Ft,Rt,_t,At,Ot,zt,$t,Dt,Ut,Vt,Bt={point:Ht,lineStart:jt,lineEnd:Ct,polygonStart:function(){Bt.point=Tt,Bt.lineStart=Xt,Bt.lineEnd=Yt,dt=new _,bt.polygonStart()},polygonEnd:function(){bt.polygonEnd(),Bt.point=Ht,Bt.lineStart=jt,Bt.lineEnd=Ct,mt<0?(ot=-(st=180),at=-(ct=90)):dt>A?ct=90:dt<-A&&(at=-90),pt[0]=ot,pt[1]=st},sphere:function(){ot=-(st=180),at=-(ct=90)}};function Ht(t,n){gt.push(pt=[ot=t,st=t]),n<at&&(at=n),n>ct&&(ct=n)}function It(t,n){var e,i,r=function(t){var n=t[0],e=t[1],i=I(e);return[i*I(n),i*C(n),C(e)]}([t*V,n*V]);if(ft){var o=St(ft,r),a=St([o[1],-o[0],0],o);i=T((e=a)[0]*e[0]+e[1]*e[1]+e[2]*e[2]),e[0]/=i,e[1]/=i,e[2]/=i,a=function(t){return[H(t[1],t[0]),X(t[2])]}(a);var s,c=t-ut,u=c>0?1:-1,l=a[0]*U*u,h=B(c)>180;h^(u*ut<l&&l<u*t)?(s=a[1]*U)>ct&&(ct=s):h^(u*ut<(l=(l+360)%360-180)&&l<u*t)?(s=-a[1]*U)<at&&(at=s):(n<at&&(at=n),n>ct&&(ct=n)),h?t<ut?Gt(ot,t)>Gt(ot,st)&&(st=t):Gt(t,st)>Gt(ot,st)&&(ot=t):st>=ot?(t<ot&&(ot=t),t>st&&(st=t)):t>ut?Gt(ot,t)>Gt(ot,st)&&(st=t):Gt(t,st)>Gt(ot,st)&&(ot=t)}else gt.push(pt=[ot=t,st=t]);n<at&&(at=n),n>ct&&(ct=n),ft=r,ut=t}function jt(){Bt.point=It}function Ct(){pt[0]=ot,pt[1]=st,Bt.point=Ht,ft=null}function Tt(t,n){if(ft){var e=t-ut;dt.add(B(e)>180?e+(e>0?360:-360):e)}else lt=t,ht=n;bt.point(t,n),It(t,n)}function Xt(){bt.lineStart()}function Yt(){Tt(lt,ht),bt.lineEnd(),B(dt)>A&&(ot=-(st=180)),pt[0]=ot,pt[1]=st,ft=null}function Gt(t,n){return(n-=t)<0?n+360:n}function Wt(t,n){return t[0]-n[0]}function Jt(t,n){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var Kt={sphere:Y,point:Qt,lineStart:tn,lineEnd:rn,polygonStart:function(){Kt.lineStart=on,Kt.lineEnd=an},polygonEnd:function(){Kt.lineStart=tn,Kt.lineEnd=rn}};function Qt(t,n){t*=V;var e=I(n*=V);Zt(e*I(t),e*C(t),C(n))}function Zt(t,n,e){++kt,Et+=(t-Et)/kt,Pt+=(n-Pt)/kt,qt+=(e-qt)/kt}function tn(){Kt.point=nn}function nn(t,n){t*=V;var e=I(n*=V);Dt=e*I(t),Ut=e*C(t),Vt=C(n),Kt.point=en,Zt(Dt,Ut,Vt)}function en(t,n){t*=V;var e=I(n*=V),i=e*I(t),r=e*C(t),o=C(n),a=H(T((a=Ut*o-Vt*r)*a+(a=Vt*i-Dt*o)*a+(a=Dt*r-Ut*i)*a),Dt*i+Ut*r+Vt*o);Mt+=a,Lt+=a*(Dt+(Dt=i)),Ft+=a*(Ut+(Ut=r)),Rt+=a*(Vt+(Vt=o)),Zt(Dt,Ut,Vt)}function rn(){Kt.point=Qt}function on(){Kt.point=sn}function an(){cn(zt,$t),Kt.point=Qt}function sn(t,n){zt=t,$t=n,t*=V,n*=V,Kt.point=cn;var e=I(n);Dt=e*I(t),Ut=e*C(t),Vt=C(n),Zt(Dt,Ut,Vt)}function cn(t,n){t*=V;var e=I(n*=V),i=e*I(t),r=e*C(t),o=C(n),a=Ut*o-Vt*r,s=Vt*i-Dt*o,c=Dt*r-Ut*i,u=j(a,s,c),l=X(u),h=u&&-l/u;_t.add(h*a),At.add(h*s),Ot.add(h*c),Mt+=l,Lt+=l*(Dt+(Dt=i)),Ft+=l*(Ut+(Ut=r)),Rt+=l*(Vt+(Vt=o)),Zt(Dt,Ut,Vt)}function un(t,n){return function(e,i,r){if(e){const n=F(e,(r||this).context);return n&&n.path[t](i)}return n(i)}}const ln=un("area",(function(t){return yt=new _,Z(t,bt),2*yt})),hn=un("bounds",(function(t){var n,e,i,r,o,a,s;if(ct=st=-(ot=at=1/0),gt=[],Z(t,Bt),e=gt.length){for(gt.sort(Wt),n=1,o=[i=gt[0]];n<e;++n)Jt(i,(r=gt[n])[0])||Jt(i,r[1])?(Gt(i[0],r[1])>Gt(i[0],i[1])&&(i[1]=r[1]),Gt(r[0],i[1])>Gt(i[0],i[1])&&(i[0]=r[0])):o.push(i=r);for(a=-1/0,n=0,i=o[e=o.length-1];n<=e;i=r,++n)r=o[n],(s=Gt(i[1],r[0]))>a&&(a=s,ot=r[0],st=i[1])}return gt=pt=null,ot===1/0||at===1/0?[[NaN,NaN],[NaN,NaN]]:[[ot,at],[st,ct]]})),fn=un("centroid",(function(t){kt=Mt=Et=Pt=qt=Lt=Ft=Rt=0,_t=new _,At=new _,Ot=new _,Z(t,Kt);var n=+_t,e=+At,i=+Ot,r=j(n,e,i);return r<1e-12&&(n=Lt,e=Ft,i=Rt,Mt<A&&(n=Et,e=Pt,i=qt),(r=j(n,e,i))<1e-12)?[NaN,NaN]:[H(e,n)*U,X(i/r)*U]}));function dn(t){const n=this.context.group;let e=!1;if(n)for(;t;){if(t===n){e=!0;break}t=t.mark.group}return e}function gn(t,n,e){try{t[n].apply(t,["EXPRESSION"].concat([].slice.call(e)))}catch(n){t.warn(n)}return e[e.length-1]}function pn(){return gn(this.context.dataflow,"warn",arguments)}function mn(){return gn(this.context.dataflow,"info",arguments)}function yn(){return gn(this.context.dataflow,"debug",arguments)}function bn(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function wn(t,n){var e=Object.create(t.prototype);for(var i in n)e[i]=n[i];return e}function vn(){}var xn=.7,Nn=1/xn,Sn="\\s*([+-]?\\d+)\\s*",kn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Mn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",En=/^#([0-9a-f]{3,8})$/,Pn=new RegExp("^rgb\\("+[Sn,Sn,Sn]+"\\)$"),qn=new RegExp("^rgb\\("+[Mn,Mn,Mn]+"\\)$"),Ln=new RegExp("^rgba\\("+[Sn,Sn,Sn,kn]+"\\)$"),Fn=new RegExp("^rgba\\("+[Mn,Mn,Mn,kn]+"\\)$"),Rn=new RegExp("^hsl\\("+[kn,Mn,Mn]+"\\)$"),_n=new RegExp("^hsla\\("+[kn,Mn,Mn,kn]+"\\)$"),An={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function On(){return this.rgb().formatHex()}function zn(){return this.rgb().formatRgb()}function $n(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=En.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?Dn(n):3===e?new Hn(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?Un(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?Un(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=Pn.exec(t))?new Hn(n[1],n[2],n[3],1):(n=qn.exec(t))?new Hn(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=Ln.exec(t))?Un(n[1],n[2],n[3],n[4]):(n=Fn.exec(t))?Un(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=Rn.exec(t))?Tn(n[1],n[2]/100,n[3]/100,1):(n=_n.exec(t))?Tn(n[1],n[2]/100,n[3]/100,n[4]):An.hasOwnProperty(t)?Dn(An[t]):"transparent"===t?new Hn(NaN,NaN,NaN,0):null}function Dn(t){return new Hn(t>>16&255,t>>8&255,255&t,1)}function Un(t,n,e,i){return i<=0&&(t=n=e=NaN),new Hn(t,n,e,i)}function Vn(t){return t instanceof vn||(t=$n(t)),t?new Hn((t=t.rgb()).r,t.g,t.b,t.opacity):new Hn}function Bn(t,n,e,i){return 1===arguments.length?Vn(t):new Hn(t,n,e,null==i?1:i)}function Hn(t,n,e,i){this.r=+t,this.g=+n,this.b=+e,this.opacity=+i}function In(){return"#"+Cn(this.r)+Cn(this.g)+Cn(this.b)}function jn(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Cn(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Tn(t,n,e,i){return i<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new Gn(t,n,e,i)}function Xn(t){if(t instanceof Gn)return new Gn(t.h,t.s,t.l,t.opacity);if(t instanceof vn||(t=$n(t)),!t)return new Gn;if(t instanceof Gn)return t;var n=(t=t.rgb()).r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),o=Math.max(n,e,i),a=NaN,s=o-r,c=(o+r)/2;return s?(a=n===o?(e-i)/s+6*(e<i):e===o?(i-n)/s+2:(n-e)/s+4,s/=c<.5?o+r:2-o-r,a*=60):s=c>0&&c<1?0:a,new Gn(a,s,c,t.opacity)}function Yn(t,n,e,i){return 1===arguments.length?Xn(t):new Gn(t,n,e,null==i?1:i)}function Gn(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}function Wn(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}bn(vn,$n,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:On,formatHex:On,formatHsl:function(){return Xn(this).formatHsl()},formatRgb:zn,toString:zn}),bn(Hn,Bn,wn(vn,{brighter:function(t){return t=null==t?Nn:Math.pow(Nn,t),new Hn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?xn:Math.pow(xn,t),new Hn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:In,formatHex:In,formatRgb:jn,toString:jn})),bn(Gn,Yn,wn(vn,{brighter:function(t){return t=null==t?Nn:Math.pow(Nn,t),new Gn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?xn:Math.pow(xn,t),new Gn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*n,r=2*e-i;return new Hn(Wn(t>=240?t-240:t+120,r,i),Wn(t,r,i),Wn(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const Jn=Math.PI/180,Kn=180/Math.PI,Qn=.96422,Zn=.82521,te=4/29,ne=6/29,ee=3*ne*ne;function ie(t){if(t instanceof oe)return new oe(t.l,t.a,t.b,t.opacity);if(t instanceof fe)return de(t);t instanceof Hn||(t=Vn(t));var n,e,i=ue(t.r),r=ue(t.g),o=ue(t.b),a=ae((.2225045*i+.7168786*r+.0606169*o)/1);return i===r&&r===o?n=e=a:(n=ae((.4360747*i+.3850649*r+.1430804*o)/Qn),e=ae((.0139322*i+.0971045*r+.7141733*o)/Zn)),new oe(116*a-16,500*(n-a),200*(a-e),t.opacity)}function re(t,n,e,i){return 1===arguments.length?ie(t):new oe(t,n,e,null==i?1:i)}function oe(t,n,e,i){this.l=+t,this.a=+n,this.b=+e,this.opacity=+i}function ae(t){return t>.008856451679035631?Math.pow(t,1/3):t/ee+te}function se(t){return t>ne?t*t*t:ee*(t-te)}function ce(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ue(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function le(t){if(t instanceof fe)return new fe(t.h,t.c,t.l,t.opacity);if(t instanceof oe||(t=ie(t)),0===t.a&&0===t.b)return new fe(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var n=Math.atan2(t.b,t.a)*Kn;return new fe(n<0?n+360:n,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function he(t,n,e,i){return 1===arguments.length?le(t):new fe(t,n,e,null==i?1:i)}function fe(t,n,e,i){this.h=+t,this.c=+n,this.l=+e,this.opacity=+i}function de(t){if(isNaN(t.h))return new oe(t.l,0,0,t.opacity);var n=t.h*Jn;return new oe(t.l,Math.cos(n)*t.c,Math.sin(n)*t.c,t.opacity)}function ge(t){const n=t/255;return n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}function pe(t){const n=Bn(t);return.2126*ge(n.r)+.7152*ge(n.g)+.0722*ge(n.b)}function me(t,n){const e=pe(t),i=pe(n);return(Math.max(e,i)+.05)/(Math.min(e,i)+.05)}function ye(){const t=[].slice.call(arguments);return t.unshift({}),n.extend(...t)}function be(t,e){return t===e||t!=t&&e!=e||(n.isArray(t)?!(!n.isArray(e)||t.length!==e.length)&&function(t,n){for(let e=0,i=t.length;e<i;++e)if(!be(t[e],n[e]))return!1;return!0}(t,e):!(!n.isObject(t)||!n.isObject(e))&&we(t,e))}function we(t,n){for(const e in t)if(!be(t[e],n[e]))return!1;return!0}function ve(t){return n=>we(t,n)}function xe(t,e,r,o,a,s){const c=this.context.dataflow,u=this.context.data[t],l=u.input,h=c.stamp();let f,d,g=u.changes;if(!1===c._trigger||!(l.value.length||e||o))return 0;if((!g||g.stamp<h)&&(u.changes=g=c.changeset(),g.stamp=h,c.runAfter(()=>{u.modified=!0,c.pulse(l,g).run()},!0,1)),r&&(f=!0===r?n.truthy:n.isArray(r)||i.isTuple(r)?r:ve(r),g.remove(f)),e&&g.insert(e),o&&(f=ve(o),l.value.some(f)?g.remove(f):g.insert(o)),a)for(d in s)g.modify(a,d,s[d]);return 1}function Ne(t){const n=t.touches,e=n[0].clientX-n[1].clientX,i=n[0].clientY-n[1].clientY;return Math.sqrt(e*e+i*i)}function Se(t){const n=t.touches;return Math.atan2(n[0].clientY-n[1].clientY,n[0].clientX-n[1].clientX)}function ke(t,n,e){return r.bandSpace(t||0,n||0,e||0)}function Me(t,n){const e=F(t,(n||this).context);return e&&e.bandwidth?e.bandwidth():0}function Ee(t,n){const e=F(t,(n||this).context);return e?e.copy():void 0}function Pe(t,n){const e=F(t,(n||this).context);return e?e.domain():[]}function qe(t,e,i){const r=F(t,(i||this).context);return r?n.isArray(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}function Le(t,n){const e=F(t,(n||this).context);return e&&e.range?e.range():[]}function Fe(t,n,e){const i=F(t,(e||this).context);return i?i(n):void 0}function Re(t,e,i,a,s){t=F(t,(s||this).context);const c=o.Gradient(e,i);let u=t.domain(),l=u[0],h=n.peek(u),f=n.identity;return h-l?f=r.scaleFraction(t,l,h):t=(t.interpolator?r.scale("sequential")().interpolator(t.interpolator()):r.scale("linear")().interpolate(t.interpolate()).range(t.range())).domain([l=0,h=1]),t.ticks&&(u=t.ticks(+a||15),l!==u[0]&&u.unshift(l),h!==n.peek(u)&&u.push(h)),u.forEach(n=>c.stop(f(n),t(n))),c}function _e(t,n,e){const i=F(t,(e||this).context);return function(t){return i?i.path.context(t)(n):""}}function Ae(t){let n=null;return function(e){return e?o.pathRender(e,n=n||o.pathParse(t)):t}}bn(oe,re,wn(vn,{brighter:function(t){return new oe(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new oe(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,n=isNaN(this.a)?t:t+this.a/500,e=isNaN(this.b)?t:t-this.b/200;return new Hn(ce(3.1338561*(n=Qn*se(n))-1.6168667*(t=1*se(t))-.4906146*(e=Zn*se(e))),ce(-.9787684*n+1.9161415*t+.033454*e),ce(.0719453*n-.2289914*t+1.4052427*e),this.opacity)}})),bn(fe,he,wn(vn,{brighter:function(t){return new fe(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new fe(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return de(this).rgb()}}));const Oe=t=>t.data;function ze(t,n){const e=u.call(n,t);return e.root&&e.root.lookup||{}}function $e(t,n,e){const i=ze(t,this),r=i[n],o=i[e];return r&&o?r.path(o).map(Oe):void 0}function De(t,n){const e=ze(t,this)[n];return e?e.ancestors().map(Oe):void 0}const Ue=()=>"undefined"!=typeof window&&window||null;function Ve(){const t=Ue();return t?t.screen:{}}function Be(){const t=Ue();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]}function He(){const t=this.context.dataflow,n=t.container&&t.container();return n?[n.clientWidth,n.clientHeight]:[void 0,void 0]}const Ie={random:()=>s.random(),cumulativeNormal:s.cumulativeNormal,cumulativeLogNormal:s.cumulativeLogNormal,cumulativeUniform:s.cumulativeUniform,densityNormal:s.densityNormal,densityLogNormal:s.densityLogNormal,densityUniform:s.densityUniform,quantileNormal:s.quantileNormal,quantileLogNormal:s.quantileLogNormal,quantileUniform:s.quantileUniform,sampleNormal:s.sampleNormal,sampleLogNormal:s.sampleLogNormal,sampleUniform:s.sampleUniform,isArray:n.isArray,isBoolean:n.isBoolean,isDate:n.isDate,isDefined:t=>void 0!==t,isNumber:n.isNumber,isObject:n.isObject,isRegExp:n.isRegExp,isString:n.isString,isTuple:i.isTuple,isValid:t=>null!=t&&t==t,toBoolean:n.toBoolean,toDate:n.toDate,toNumber:n.toNumber,toString:n.toString,flush:n.flush,lerp:n.lerp,merge:ye,pad:n.pad,peek:n.peek,span:n.span,inrange:n.inrange,truncate:n.truncate,rgb:Bn,lab:re,hcl:he,hsl:Yn,luminance:pe,contrast:me,sequence:function(t,n,e){t=+t,n=+n,e=(r=arguments.length)<2?(n=t,t=0,1):r<3?1:+e;for(var i=-1,r=0|Math.max(0,Math.ceil((n-t)/e)),o=new Array(r);++i<r;)o[i]=t+i*e;return o},format:g,utcFormat:m,utcParse:b,utcOffset:c.utcOffset,utcSequence:c.utcSequence,timeFormat:p,timeParse:y,timeOffset:c.timeOffset,timeSequence:c.timeSequence,timeUnitSpecifier:c.timeUnitSpecifier,monthFormat:x,monthAbbrevFormat:N,dayFormat:S,dayAbbrevFormat:k,quarter:n.quarter,utcquarter:n.utcquarter,week:c.week,utcweek:c.utcweek,dayofyear:c.dayofyear,utcdayofyear:c.utcdayofyear,warn:pn,info:mn,debug:yn,extent:n.extent,inScope:dn,intersect:function(t,e,i){if(!t)return[];const[r,a]=t,s=(new o.Bounds).set(r[0],r[1],a[0],a[1]),c=i||this.context.dataflow.scenegraph().root;return o.intersect(c,s,function(t){let e=null;if(t){const i=n.array(t.marktype),r=n.array(t.markname);e=t=>(!i.length||i.some(n=>t.marktype===n))&&(!r.length||r.some(n=>t.name===n))}return e}(e))},clampRange:n.clampRange,pinchDistance:Ne,pinchAngle:Se,screen:Ve,containerSize:He,windowSize:Be,bandspace:ke,setdata:h,pathShape:Ae,panLinear:n.panLinear,panLog:n.panLog,panPow:n.panPow,panSymlog:n.panSymlog,zoomLinear:n.zoomLinear,zoomLog:n.zoomLog,zoomPow:n.zoomPow,zoomSymlog:n.zoomSymlog,encode:f,modify:xe},je=["view","item","group","xy","x","y"],Ce="this.",Te={},Xe={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(n.stringValue("$"+t),"]"),functions:function(t){const i=e.functions(t);je.forEach(t=>i[t]="event.vega."+t);for(const t in Ie)i[t]=Ce+t;return n.extend(i,R(t,Ie,Te)),i},constants:e.constants,visitors:Te},Ye=e.codegen(Xe);function Ge(t,n,e){return 1===arguments.length?Ie[t]:(Ie[t]=n,e&&(Te[t]=e),Ye&&(Ye.functions[t]=Ce+t),this)}return Ge("bandwidth",Me,q),Ge("copy",Ee,q),Ge("domain",Pe,q),Ge("range",Le,q),Ge("invert",qe,q),Ge("scale",Fe,q),Ge("gradient",Re,q),Ge("geoArea",ln,q),Ge("geoBounds",hn,q),Ge("geoCentroid",fn,q),Ge("geoShape",_e,q),Ge("indata",l,P),Ge("data",u,E),Ge("treePath",$e,E),Ge("treeAncestors",De,E),Ge("vlSelectionTest",a.selectionTest,a.selectionVisitor),Ge("vlSelectionResolve",a.selectionResolve,a.selectionVisitor),t.DataPrefix=":",t.IndexPrefix="@",t.ScalePrefix=M,t.SignalPrefix="$",t.bandspace=ke,t.bandwidth=Me,t.codeGenerator=Ye,t.codegenParams=Xe,t.containerSize=He,t.contrast=me,t.copy=Ee,t.data=u,t.dataVisitor=E,t.dayAbbrevFormat=k,t.dayFormat=S,t.debug=yn,t.domain=Pe,t.encode=f,t.expressionFunction=Ge,t.format=g,t.functionContext=Ie,t.geoArea=ln,t.geoBounds=hn,t.geoCentroid=fn,t.geoShape=_e,t.inScope=dn,t.indata=l,t.indataVisitor=P,t.info=mn,t.invert=qe,t.luminance=pe,t.merge=ye,t.modify=xe,t.monthAbbrevFormat=N,t.monthFormat=x,t.parseExpression=function(t,i){const r={};let o;try{t=n.isString(t)?t:n.stringValue(t)+"",o=e.parse(t)}catch(e){n.error("Expression parse error: "+t)}o.visit(t=>{if(t.type!==e.CallExpression)return;const n=t.callee.name,o=Xe.visitors[n];o&&o(n,t.arguments,i,r)});const a=Ye(o);return a.globals.forEach(t=>{const e="$"+t;!n.hasOwnProperty(r,e)&&i.getSignal(t)&&(r[e]=i.signalRef(t))}),{$expr:n.extend({code:a.code},i.options.ast?{ast:o}:null),$fields:a.fields,$params:r}},t.pathShape=Ae,t.pinchAngle=Se,t.pinchDistance=Ne,t.range=Le,t.scale=Fe,t.scaleGradient=Re,t.scaleVisitor=q,t.screen=Ve,t.setdata=h,t.timeFormat=p,t.timeParse=y,t.treeAncestors=De,t.treePath=$e,t.utcFormat=m,t.utcParse=b,t.warn=pn,t.windowSize=Be,t}({},vega,vega,vega,vega,vega,vega,vega,vega);
//# sourceMappingURL=vega-functions.min.js.map
